\section{Tyrimo dalis}

    Siekiant ištirti, kaip dirbtiniai neuroniniai tinklai reaguoja į triukšmą duomenyse, buvo atlikti bandymai su sukurtu dirbtinio neuroninio tinklo modeliu. Papildomai, norint įvertinti, kiek geriau dirbtinis neuroninis tinklas susitvarko su triukšmu duomenyse, tam pačiam uždaviniui buvo pritaikyti ir keli k artimiausių kaimynų modeliai. Visi modeliai buvo pritaikyti tiek su švariom duomenų aibėm, tiek su aibėm, kuriose yra pritaikytas tam tikras triukšmo lygis. 
    
    Tyrimo dalies išeities kodas pateikiamas GitHub repozitorijoje:
    \begin{center}
        \url{https://github.com/zhemepatis/VU-7-C/tree/main/code}
    \end{center}

    \subsection{Naudoti įrankiai}
        
        Tyrimo dalies įgyvendinimui buvo naudojami šie įrankiai:

        \begin{itemize}
            \item Python 3.14.2 – pagrindinė programavimo kalba
            \item Jupyter Notebooks – interaktyviam bandymų vykdymui ir rezultatų vizualizavimui
            \item NumPy – skaitiniams skaičiavimams
            \item Matplotlib – duomenų vizualizacijai
            \item scikit-learn – mašininio mokymosi algoritmams
            \item PyTorch – neuroninių tinklų kūrimui
            \item venv – virtualių aplinkų valdymui
        \end{itemize}

    \subsection{Duomenų aibė}

        Bandymams atlikti buvo generuojami keturmačiai duomenys, kurių kiekviena komponentė buvo parenkama iš intervalo $[-5; 5]$. Duomenys buvo generuoti naudojant sferos (\ref{eq:sferos_etalono_funkc} lygtis) funkciją. 
        
        Modeliai buvo pritaikyti skirtingo dydžio aibėms. Dirbtinis neuroninis tinklas buvo pritaikytas su 1~000, 10~000, 100~000, 1~000~000 dydžio duomenų aibėmis, tuo tarpu k artimiausių kaimynų metodas dar papildomai buvo išbandytas su aibe, turinčia 10~000~000 įrašų. 
        
        Triukšmo pridėjimui į duomenų aibę buvo pasitelktas Gauso paskirsymo funkcijos metodas. Paklaidos buvo pridedamos prie sugeneruotų etalono funkcijų reikšmių. Triukšmas buvo generuojamos su parametrais $\mu = 0$, $\sigma = 0.5$.

        Prieš apmokant dirbtinio neuroninio tinklos modelį duomenys buvo normalizuojami min-max metodu. Perėjus prie modelio statistinių rodiklių įvertinimo duomenys buvo grąžinami į pradinį duomenų mąstelį. Tad atsižvelgus į tai, kad duomenys buvo generuoti sferos funkcija prognozės absoliutinė paklaida įeina į intervalą $[0; 100].$

    \subsection{Bandymai su dirbtiniu neuroniniu tinklu}

        \subsubsection{Modelis}

            Darbo metu buvo sukurtas modelis, sudarytas iš vieno įvesties sluoksnio (4 neuronai), vieno paslėpto sluoksnio (70 neuronų) bei vieno išvesties sluoksnio (1 neuronas). Paslėptajame sluoksnyje buvo panaudota sigmoidinė aktyvavimo funkcija, tuo tarpu išvesties sluoksnyje aktyvavimo funkcija pritaikyta nebuvo. Tokia dirbtinio neuroninio tinklo architektūra buvo pasirinkta remiantis teorema, teigiančia, kad bet kuri tolydi funkcija gali būti aproksimuota dirbtiniu neuroniniu tinklu, turinčiu vieną paslėptą sluoksnį su netiesine sigmoidine aktyvavimo funkcija \cite{cybenko_aproximation}. 

            Modelio mokymosi ilgio reikšmė buvo lygi $0,01$, o mokymosi aibė buvo padalinta į dalis po 8 įrašus. Modelio apmokymo etapas buvo stabdomas įvykus vienai iš stabdymo sąlygų:
            \begin{itemize}
                \item klaidos funkcijos reikšmė $13$ epochų iš eilės mažėja mažiau nei per $10^{-6}$;
                \item buvo pasiektas maksimalus $150$ epochų kiekis.
            \end{itemize}

            Modelio apmokymui buvo skiriama $70\%$ aibės duomenų, $15\%$ buvo skiriama modelio validavimui, ir kiti $15\%$ - modelio testavimui. 

        \subsubsection{Rezultatai}
            
            Nagrinėjant modelio rezultatus su švariais duomenim (\ref{tbl:fnn_sferos_funkc_svarus} lentelė) matome, kad, didžiąja dalimi, didinant taškų kiekį, modelio absoliutinės paklaidos vidurkis ir standartinis nuokrypis mažėjo. Išsiskiria tik atvejis su 1~000~000 taškų aibe - modelis grąžino blogesnius rezultatus lyginant su rezultatais, gautais naudojant 100~000 taškų aibę. Žvelgiant į standartinio nuokrypio reikšmes, matome analogišką dėsningumą.

            Lyginant modelio rodiklius skirtingam taškų kiekiui, matyti, kad abiem gerėjimo atvejais absoliučios paklaidos vidurkis sumažėjo atitinkamai 64,7\% ir 65,1\%. Tuo tarpu standartinis nuokrypis, didinant duomenų aibės dydį nuo 1~000 iki 10~000, sumažėjo 58,1\%, o nuo 1~000 iki 100~000 – 66,6\%.        
            
            \input{attachments/tables/fnn_sferos_funkc_svarus}

            Pažvelgus į modelio rezultatus su triukšmingais duomenim (\ref{tbl:fnn_sferos_funkc_su_triuksmu} lentelė), matome kiek kitokius rezultatus. Šiuo atveju taip pat didinant aibės dydį, daugeliu atveju, absoliutinės paklaidos vidurkis mažėjo. Vienintėlis atvejis, kai didinant duomenų aibę vidurkio reikšmė suprastėjo, buvo keičiant įrašų kiekį iš 1~000 į 10~000. Kalbant apie standartinio nuokrypio reikšmes, matome, kad šis statistinis rodiklis šiuo atveju stabiliai mažėjo. 
            
            Atkreipus dėmesį į statistinių rodiklių pokytį keičiant duomenų aibės dydį, matyti, kad didinant taškų skaičių nuo 10~000 iki 100~000, vidurkis sumažėjo 74,8\%, o keičiant aibę iš 100~000 į 1~000~000, vidurkis sumažėjo apie 21,8\%. Tuo tarpu standartinis nuokrypis, keičiant įrašų skaičių iš 1~000 į 10~000, iš 10~000 į 100~000 bei iš 100~000 į 1~000~000, sumažėjo atitinkamai 35,7\%, 65,8\% ir 33,7\%.
            
            \input{attachments/tables/fnn_sferos_funkc_su_triuksmu}

            Vertinant modelio tikslumo pokytį tarp švarios ir triukšmingos duomenų aibių, matyti, kad mažiausią įtaką triukšmas turėjo duomenų aibei su 1~000~000 taškų – modelio absoliučios paklaidos vidurkis padidėjo 0,9\%, o standartinis nuokrypis – 1,8\%. Šiek tiek didesni pokyčiai stebimi bandymuose su 1~000 įrašų duomenų aibe, kur vidurkis padidėjo 11,1\%, o standartinis nuokrypis – 55,1\%. Didžiausi pakitimai pastebimi nagrinėjant 10~000 ir 100~000 įrašų duomenų aibes: šiose aibėse vidurkis padidėjo atitinkamai 240\% ir 146,3\%, o standartinis nuokrypis – 138,4\% ir 144,1\%.
    
    \subsection{Bandymai su k artimiausių kaimynų metodu}

        \subsubsection{Modeliai}
            
            Dirbtinio neuroninio tinklo įvertinimui tos pačios duomenų aibės buvo panaudotos ir su k artimiausių kaimynų metodu. 85\% kiekvienos duomenų aibės įrašų buvo skiriami duomenų saugojimui ir validavimui, o likę 15\% – modelio testavimui. Modeliai buvo validuojami pasitelkiant kryžminę validaciją (angl.~\textit{cross-validation}). Nustatyta, kad geriausi rezultatai pasiekiami, kai kaimynų skaičius lygus 3, tačiau palyginimui buvo atlikti ir bandymai su vienu artimiausiu kaimynu.

        \subsubsection{Rezultatai (k = 1)}
            
            Tiriant modelio rezultatus su švaria duomenų aibe (\ref{tbl:nn_sferos_funkc_svarus}~lentelė), matyti, kad tiek absoliučios paklaidos vidurkis, tiek standartinis nuokrypis, didinant duomenų aibės dydį, nuosekliai mažėja. Vidurkio reikšmių pokytis išlieka gana tolygus: didžiausias sumažėjimas siekia 43,9\% (didinant duomenų aibę nuo 1~000~000 iki 10~000~000), o mažiausias – 42,6\% (didinant duomenų aibę nuo 1~000 iki 10~000). 
            
            Standartinio nuokrypio atveju stebima panaši tendencija, tačiau sumažėjimo skirtumai yra kiek didesni. Be to, galima pastebėti, kad lyginant didesnės apimties duomenų aibes, standartinio nuokrypio sumažėjimas didėja. Didžiausias sumažėjimas siekė 44,4\% didinant duomenų aibę nuo 1~000~000 iki 10~000~000 taškų, o mažiausias – 35,6\%, kai aibė buvo didinama nuo 1~000 iki 10~000 taškų.
            
            \input{attachments/tables/nn_sferos_funkc_svarus}

            Nagrinėjant triukšmingus duomenis (\ref{tbl:nn_sferos_funkc_su_triuksmu}~lentelė), matyti, kad absoliučios paklaidos vidurkis ir standartinis nuokrypis, didinant taškų skaičių, nuosekliai mažėja. Taip pat galima pastebėti, kad nors vidurkio sumažėjimas tarp skirtingų aibės dydžių yra santykinai tolygus, didėjant duomenų kiekiui šis pokytis palaipsniui mažėja: vidurkio pokytis sumažėjo nuo 42,6\% didinant taškų skaičių nuo 1~000 iki 10~000 iki 35,6\% didinant aibę nuo 100~000 iki 1~000~000.
            
            Standartinio nuokrypio rodiklis tokio dėsningumo neparodo. Didžiausias vidurkio pokytis stebimas didinant duomenų aibę nuo 10~000 iki 100~000 taškų, kai standartinis nuokrypis sumažėjo 42,3\%. Mažiausias pokytis pastebimas atveju, kai aibė buvo didinama nuo 1~000 iki 10~000 taškų – tuomet sumažėjimas siekė 36,4\%.
            
            \input{attachments/tables/nn_sferos_funkc_su_triuksmu}

            Vertinant triukšmo pridėjimo įtaką modelio tikslumui, matyti, kad poveikis vidurkio reikšmėms nuosekliai didėjo. Didžiausias triukšmo poveikis buvo nustatytas 10~000~000 taškų duomenų aibei, kur vidurkio padidėjimas siekė 24,7\%. Tuo tarpu mažiausia įtaka buvo stebima nagrinėjant 1~000 įrašų duomenų aibę, vidurkio padidėjimas buvo apytiksliai 0,7\%.

            Kalbant apie standartinio nuokrypio reikšmes, didžiausias šio statistinio rodiklio padidėjimas pastebimas nagrinėjant 10~000~000 įrašų duomenų aibę – jis siekia 23,3\%. Tuo tarpu mažiausias šio rodiklio suprastėjimas stebimas 10~000 įrašų duomenų aibėje ir yra lygus 0.8\%.

        \subsubsection{Rezultatai (k = 3)}

            Vertinant modelio rezultatus su švaria duomenų aibe, matyti, kad absoliučios paklaidos vidurkio ir standartinio nuokrypio pokyčiai, didinant duomenų aibės dydį, yra gana nuoseklūs. Vidurkio reikšmių pokytis išlieka pastovus: didžiausias sumažėjimas siekia 46,4 \% (didinant duomenų aibę nuo 10~000 iki 100~000), o mažiausias – 42,7\% (keičiant aibės dydį iš 1~000 į 10~000 įrašų).
            
            Standartinio nuokrypio atveju pastebima panaši tendencija: didžiausias sumažėjimas – 50,5\% – buvo pasiektas didinant aibę nuo 1~000 iki 10~000 taškų, o mažiausias – 45,43\% – didinant aibę nuo 1~000~000 iki 10~000~000.

            \input{attachments/tables/knn_sferos_funkc_svarus}

            Analizuojant triukšmingus duomenis, galima matyti, kad vidurkio ir standartinio nuokrypio pokyčiai mažėjant duomenų aibės dydžiui yra mažiau tolygūs nei švarioje aibėje. Vidurkio sumažėjimas tarp skirtingų aibės dydžių palaipsniui mažėja: pradiniu etapu jis siekė 42,7 \%, o vėlesniame etape sumažėjo iki 38,44\%. 
            
            Standartinio nuokrypio pokyčiai taip pat svyruoja – didžiausias sumažėjimas buvo 50,5\%, mažiausias – 40,4 \%. Tai rodo, kad triukšmo buvimas didina modelio rezultatų kintamumą, ypatingai mažesnėse aibėse.

            \input{attachments/tables/knn_sferos_funkc_su_triuksmu}

            Vertinant triukšmo įtaką modelio tikslumui, matyti, kad triukšmo poveikis vidurkiui ir standartiniam nuokrypiui didėjant duomenų kiekiui kinta netolygiai. Išsiskiria ir tai, kad su 1~000 įrašų aibe modelio absoliuotinė paklaida vidutiniškai buvo šiek tiek geresnė su triukšmingais duomenimis nei su švariais. Didžiausias vidurkio suprastėjimas buvo gautas su 10~000~000 įrašų aibe – jis siekė 18,2\%, o mažiausias suprastėjimas buvo pasiektas su 10~000 įrašų ir siekė 0,03\%.

            Triukšmo įtaka standartiniam nuokrypiui yra panaši. Nors visais atvejais šio statistinio rodiklio reikšmė buvo didesnė su triukšminga aibe, pokyčiai buvo panašūs į vidurkio pokyčius. Didžiausias pokytis buvo pasiektas su 10~000~000 įrašų aibe – jis siekė 13,6\%. Mažiausias rodiklio padidėjimas buvo stebimas su 10~000 taškų duomenų aibe ir siekė 0,11\%.

        \subsubsection{Rezultatų palyginimas}
            
            Atlikus bandymus su dirbtiniu neuroniniu tinklu ir k artimiausių kaimynų metodu, galima pastebėti aiškius skirtumus tarp šių modelių elgsenos, ypatingai nagrinėjant triukšmo įtaką modelių tikslumui ir stabilumui.

            \paragraph{Rezultatai su švariais duomenim}

                Naudojant švarias duomenų aibes, dirbtinis neuroninis tinklas visais atvejais demonstravo geresnes absoliutinės paklaidos vidurkio ir standartinio nuokrypio reikšmes. Nepaisant to, k artimiausių kaimynų metodo modeliai rodė stabilesnį šių rodiklių gerėjimą didinant duomenų aibės dydį. Priešingai, dirbtinio neuroninio tinklo atveju šių rodiklių pokyčiai buvo nestabilūs, o kai kuriais atvejais stebėtas ir jų pablogėjimas.
                
            \paragraph{Rezultatai su triukšmingais duomenim}

                Vertinant modelių rezultatus, gautus naudojant triukšmingas duomenų aibes, pastebimos analogiškos tendencijos. Visais nagrinėtais atvejais dirbtinio neuroninio tinklo modelis pasižymėjo geresniais prognozavimo rezultatais nei k artimiausių kaimynų metodo modeliai. Vis dėlto k artimiausių kaimynų metodo atveju buvo nustatyta, kad didėjant mokymo duomenų aibės dydžiui, modelio tikslumas augo nuosekliai ir panašiu tempu.
            
            \paragraph{Triukšmo įtaka rezultatams}
                
                Lyginant modelių atsparumą triukšmui, k artimiausių kaimynų metodas demonstravo nuoseklų triukšmo poveikio didėjimą, didėjant duomenų aibės apimčiai. Tuo tarpu dirbtinio neuroninio tinklo modelis tokio nuoseklumo neparodė. Be to, dirbtinio neuroninio tinklo atveju kai kuriais atvejais buvo stebėtas reikšmingai didesnis triukšmo poveikis, lyginant su k artimiausių kaimynų metodo rezultatais.