\section{Praktinė dalis}

    Siekiant įvertinti, kaip dirbtiniai neuroniniai tinklai reaguoja į triukšmą duomenyse, buvo atlikti bandymai su sukurtu dirbtinio neuroninio tinklo modeliu. Papildomai, norint įvertinti, kiek geriau dirbtinis neuroninis tinklas susitvarko su triukšmu duomenyse, tam pačiam uždaviniui buvo pritaikyti ir keli k artimiausių kaimynų modeliai. Visi modeliai buvo pritaikyti tiek su švariom duomenų aibėm, tiek su aibėm, kuriose yra pritaikytas tam tikras triukšmo lygis.
        
    % TODO: move somwhere else
    % Prieš pereinant prie vėlesniuose skyreliuose aptariamų tyrimų ir juose rastų rezultatų, pravartu aptarti juose vartojamas sąvokas. Šio darbo kontekste laikysime, kad \enquote{epocha} tai yra modelio perėjimas per visą apmokymo duomenų aibę, o \enquote{iteracija} yra modelio svertų atnaujinimas.

    \subsection{Duomenų aibės kūrimas}

        Bandymams atlikti buvo generuojami keturmačiai duomenys, kurių kiekviena komponentė buvo parenkama iš intervalo $[-5; 5]$. Duomenys buvo generuoti naudojant sferos (\ref{eq:sferos_etalono_funkc} lygtis) funkciją. 
        
        Modeliai buvo pritaikyti skirtingo dydžio aibėms. Dirbtinis neuroninis tinklas buvo pritaikytas su 1~000, 10~000, 100~000, 1~000~000 dydžio duomenų aibėmis, tuo tarpu k artimiausių kaimynų metodas dar papildomai buvo išbandytas su aibe, turinčia 10~000~000 įrašų. 
        
        Triukšmo pridėjimui į duomenų aibę buvo pasitelktas Gauso paskirsymo funkcijos metodas. Paklaidos buvo pridedamos prie sugeneruotų etalono funkcijų reikšmių. Triukšmas buvo generuojamos su parametrais $\mu = 0$, $\sigma = 0.5$.

        Prieš apmokant dirbtinio neuroninio tinklos modelį duomenys buvo normalizuojami min-max metodu. Perėjus prie modelio statistinių rodiklių įvertinimo duomenys buvo grąžinami į pradinį duomenų mąstelį. Tad atsižvelgus į tai, kad duomenys buvo generuoti sferos funkcija prognozės absoliutinė paklaida įeina į intervalą $[0; 100].$

    \subsection{Bandymai su dirbtiniu neuroniniu tinklu}

        \subsubsection{Modelis}

            Siekiant panagrinėti, kaip dirbtinis neuroninis tinklas susitvarko su triukšmingais duomenimis, buvo sukurtas modelis, sudarytas iš vieno įvesties sluoksnio (4 neuronai), vieno paslėpto sluoksnio (70 neuronų) bei vieno išvesties sluoksnio (1 neuronas). Paslėptajame sluoksnyje buvo panaudota sigmoidinė aktyvavimo funkcija, tuo tarpu išvesties sluoksnyje aktyvavimo funkcija pritaikyta nebuvo. Pastarasis sprendimas buvo priimtas dėl priežasties, kad dirbtinis neuroninis tinklas buvo pritaikytas spręsti regresijos uždavinį.

            Bandymų metu buvo pastebėta, kad geriausius rezultatus validacijos metu dirbtinio neuroninio tinklo modelis grąžina, kai mokymosi greitis yra $0,01$, o mokymosi bei validavimo aibės yra padalintos į dalis po 8 įrašus.

            Modelio apmokymo etapo ilgis buvo stabdomas įvykus vienai iš stabdymo sąlygų:
            \begin{itemize}
                \item klaidos funkcijos reikšmė $13$ epochų iš eilės mažėja mažiau nei per $10^{-6}$;
                \item buvo pasiektas maksimalus $150$ epochų kiekis.
            \end{itemize}

            Modelio apmokymui buvo skiriama $70\%$ aibės duomenų, $15\%$ buvo skiriama modelio validavimui, ir kiti $15\%$ - modelio testavimui. 

        \subsubsection{Rezultatai}
            
            Žemiau pateiktose \ref{tbl:fnn_sferos_funkc_svarus} ir \ref{tbl:fnn_sferos_funkc_su_triuksmu} lentelėse yra matomi dirbtinio neuroninio tinklo rezultatai su sferos funkcijos generuotais duomenimis.

            \input{attachments/tables/fnn_sferos_funkc_svarus}
            \input{attachments/tables/fnn_sferos_funkc_su_triuksmu}



    % \subsection{Dirbtinio neuroninio tinklo rezultatai}


    % \subsubsection{Sferos funkcija}

    %     \subsubsubsection{Švarūs duomenys}


    %         Matome, kad didinant taškų kiekį nuo 1~000 iki 100~000, modelio daromų paklaidų vidurkis ir standartinis nuokrypis mažėjo, taigi galime teigti, kad modelio tikslumas didėjo. Tačiau verta atkreipti dėmesį, kad padidinus taškų aibės dydį iki 1~000~000 modelio paklaidų statistiniai rodikliai pablogėjo.

    %     \subsubsubsection{Triukšmingi duomenys}

    %         Šiame bandyme buvo tiriamas neuroninio tinklo gebėjimas interpoliuoti duomenis, kurie pasižymi sferos funkcijos (\ref{lgt:sferos_funkcija} lygtis) savybėmis jiems pridėjus triukšmo.


    %         Iš \ref{tbl:fnn_sferos_funkc_su_triuksmu} lentelės matoma, kad bendru atveju vidurkis didinant taškų kiekį mažėja. Atskiras atvejis yra, kai taškų kiekis buvo padidintas iki 10~000 - tuo atveju absoliutinės paklaidos vidurkis padidėjo.

    %     \subsubsubsection{Palyginimas}

    %         Matome, kad modelio absoliutinės paklaidos vidurkis arba ženkliai nesikeitė, arba paklaidos vidurkio padidėjimas svyravo nuo 1.1 iki 3.4 kartų. Standartinio nuokrypis taip pat arba nerodė didelių pakitimų, arba paklaidos standartinio nuokrypio padidėjimas svyravo nuo 1.6 iki 2.4.

    \subsection{Bandymai su k artimiausių kaimynų metodu}

        \subsubsection{Modeliai}

        \subsubsection{Rezultatai, kai k = 1}

            \input{attachments/tables/nn_sferos_funkc_svarus}
            \input{attachments/tables/nn_sferos_funkc_su_triuksmu}

        % Žemiau esančiose lentelėse \ref{lnt:nn_sferos_funkc_paklaidos_rodikliai} ir \ref{lnt:knn_sferos_funkc_paklaidos_rodikliai} galima pamatyti modelių spėjimų absoliutinių paklaidų statistinius rodiklius. Prieš skaičiuojant šiuos rodiklius, modelių spėjimai buvo konvertuoti į originalų duomenų mastelį. Taigi atsižvelgus, kad tyrimo metu duomenys buvo apibrėžiami sferos funkcija, maksimali galima absoliutinė paklaida šio tyrimo atveju yra 100.

        \subsubsection{Rezultatai, kai k = 3}

            \input{attachments/tables/knn_sferos_funkc_svarus}
            \input{attachments/tables/knn_sferos_funkc_su_triuksmu}

        % \subsection{Bandymai su k artimiausių kaimynų metodu}

        %     Tyrimas buvo atliktas su 1~000, 10~000, 100~000, 1~000~000 ir 10~000~000 taškų aibėmis, kurių $85\%$ buvo skiriami modelio apmokymui ir validavimui, likę $15\%$ - modelio testavimui.

        %     Bandymui buvo generuojami keturmačiai duomenys ($n = 4$), kurių kiekviena komponentė buvo atsitiktinai parenkama iš intervalo $[-5; 5]$. Prieš apmokant modelį, duomenys buvo papildomai apdorojami: kiekviena vektoriaus komponentė bei sferos funkcijos reikšmės buvo normalizuojamos naudojant min–max metodą.

        %     Modelis buvo validuojamas pasitelkiant kryžminę validaciją (angl. \textit{cross-validation}). Bandymų metu buvo nustatyta, kad geriausiai modelis veikia, kai kaimynų skaičius yra lygus $3$, tačiau palyginimui buvo atlikti bandymai ir kai artimiausias kaimynas yra vienas.

        %     Visais atvejais prieš skaičiuojant statistinius absoliutinės paklaidos rodiklius, modelio spėjimai buvo konvertuoti į originalų duomenų mastelį. Taigi atsižvelgus, kad tyrimo metu duomenys buvo apibrėžiami sferos funkcija, maksimali galima absoliutinė paklaida šio tyrimo atveju yra 100.

        %     \subsubsection{Sferos funkcija, kai k = 1}

        %         \input{skyriai/praktine_dalis/knn/nn_rodikliai_0}
        %         \input{skyriai/praktine_dalis/knn/nn_rodikliai_1}
        %         \input{skyriai/praktine_dalis/knn/nn_palyginimas}

        %     \subsubsection{Sferos funkcija, kai k = 3}

        %         \input{skyriai/praktine_dalis/knn/knn_rodikliai_0}
        %         \input{skyriai/praktine_dalis/knn/knn_rodikliai_1}
        %         \input{skyriai/praktine_dalis/knn/knn_palyginimas}

        %     \subsubsection{K artimiausių kaimynų metodo rezultatų palyginimas}

        %         Palyginus metodo rezultatus, kai $k = 1$ ir $k = 3$ yra akivaizdu, kad su didesniu kaimynų kiekiu, modelis grąžina geresnius rezultatus. Taip pat matome, kad abiem atvejais, modelių grąžinami rezultatai stabiliai gerėjo.
