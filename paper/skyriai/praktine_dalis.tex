\section{Praktinė dalis}

    Siekiant įvertinti, kaip dirbtiniai neuroniniai tinklai reaguoja į triukšmą duomenyse, buvo atlikti bandymai su sukurtu dirbtinio neuroninio tinklo modeliu. Papildomai, norint įvertinti, kiek geriau dirbtinis neuroninis tinklas susitvarko su triukšmu duomenyse, tam pačiam uždaviniui buvo pritaikyti ir keli k artimiausių kaimynų modeliai. Visi modeliai buvo pritaikyti tiek su švariom duomenų aibėm, tiek su aibėm, kuriose yra pritaikytas tam tikras triukšmo lygis.
        
    % TODO: move somwhere else
    % Prieš pereinant prie vėlesniuose skyreliuose aptariamų tyrimų ir juose rastų rezultatų, pravartu aptarti juose vartojamas sąvokas. Šio darbo kontekste laikysime, kad \enquote{epocha} tai yra modelio perėjimas per visą apmokymo duomenų aibę, o \enquote{iteracija} yra modelio svertų atnaujinimas.

    \subsection{Duomenų aibės kūrimas}

        Bandymams atlikti buvo generuojami keturmačiai duomenys, kurių kiekviena komponentė buvo parenkama iš intervalo $[-5; 5]$. Duomenys buvo generuoti naudojant sferos (\ref{eq:sferos_etalono_funkc} lygtis) funkciją. 
        
        Modeliai buvo pritaikyti skirtingo dydžio aibėms. Dirbtinis neuroninis tinklas buvo pritaikytas su 1~000, 10~000, 100~000, 1~000~000 dydžio duomenų aibėmis, tuo tarpu k artimiausių kaimynų metodas dar papildomai buvo išbandytas su aibe, turinčia 10~000~000 įrašų. 
        
        Triukšmo pridėjimui į duomenų aibę buvo pasitelktas Gauso paskirsymo funkcijos metodas. Paklaidos buvo pridedamos prie sugeneruotų etalono funkcijų reikšmių. Triukšmas buvo generuojamos su parametrais $\mu = 0$, $\sigma = 0.5$.

        Prieš apmokant dirbtinio neuroninio tinklos modelį duomenys buvo normalizuojami min-max metodu. Perėjus prie modelio statistinių rodiklių įvertinimo duomenys buvo grąžinami į pradinį duomenų mąstelį. Tad atsižvelgus į tai, kad duomenys buvo generuoti sferos funkcija prognozės absoliutinė paklaida įeina į intervalą $[0; 100].$

    \subsection{Bandymai su dirbtiniu neuroniniu tinklu}

        \subsubsection{Modelis}

            Darbo metu buvo sukurtas modelis, sudarytas iš vieno įvesties sluoksnio (4 neuronai), vieno paslėpto sluoksnio (70 neuronų) bei vieno išvesties sluoksnio (1 neuronas). Paslėptajame sluoksnyje buvo panaudota sigmoidinė aktyvavimo funkcija, tuo tarpu išvesties sluoksnyje aktyvavimo funkcija pritaikyta nebuvo. Pastarasis sprendimas buvo priimtas dėl priežasties, kad dirbtinis neuroninis tinklas buvo pritaikytas spręsti regresijos uždavinį.

            Bandymų metu buvo pastebėta, kad geriausius rezultatus validacijos metu dirbtinio neuroninio tinklo modelis grąžina, kai mokymosi greitis yra $0,01$, o mokymosi bei validavimo aibės yra padalintos į dalis po 8 įrašus.

            Modelio apmokymo etapo ilgis buvo stabdomas įvykus vienai iš stabdymo sąlygų:
            \begin{itemize}
                \item klaidos funkcijos reikšmė $13$ epochų iš eilės mažėja mažiau nei per $10^{-6}$;
                \item buvo pasiektas maksimalus $150$ epochų kiekis.
            \end{itemize}

            Modelio apmokymui buvo skiriama $70\%$ aibės duomenų, $15\%$ buvo skiriama modelio validavimui, ir kiti $15\%$ - modelio testavimui. 

        \subsubsection{Rezultatai}
            
            Nagrinėjant modelio rezultatus su švariais duomenim (\ref{tbl:fnn_sferos_funkc_svarus} lentelė) matome, kad, didžiąja dalimi, didinant taškų kiekį, modelio absoliutinės paklaidos vidurkis ir standartinis nuokrypis mažėjo. Išsiskiria tik atvejis su 1~000~000 taškų aibe - modelis grąžino blogesnius rezultatus lyginant su rezultatais, gautais naudojant 100~000 taškų aibę. Žvelgiant į standartinio nuokrypio reikšmes, matome analogišką dėsningumą.

            Lyginant modelio rodiklius skirtingam taškų kiekiui, matyti, kad abiem gerėjimo atvejais absoliučios paklaidos vidurkis sumažėjo atitinkamai 64,7\% ir 65,1\%. Tuo tarpu standartinis nuokrypis, didinant duomenų aibės dydį nuo 1~000 iki 10~000, sumažėjo 58,1\%, o nuo 1~000 iki 100~000 – 66,6\%.        
            
            \input{attachments/tables/fnn_sferos_funkc_svarus}

            Pažvelgus į modelio rezultatus su triukšmingais duomenim (\ref{tbl:fnn_sferos_funkc_su_triuksmu} lentelė), matome kiek kitokius rezultatus. Šiuo atveju taip pat didinant aibės dydį, daugeliu atveju, absoliutinės paklaidos vidurkis mažėjo. Vienintėlis atvejis, kai didinant duomenų aibę vidurkio reikšmė suprastėjo, buvo keičiant įrašų kiekį iš 1~000 į 10~000. Kalbant apie standartinio nuokrypio reikšmes, matome, kad šis statistinis rodiklis šiuo atveju stabiliai mažėjo. 
            
            Atkreipus dėmesį į statistinių rodiklių pokytį keičiant duomenų aibės dydį, matyti, kad didinant taškų skaičių nuo 10~000 iki 100~000, vidurkis sumažėjo 74,8\%, o keičiant aibę iš 100~000 į 1~000~000, vidurkis sumažėjo apie 21,8\%. Tuo tarpu standartinis nuokrypis, keičiant įrašų skaičių iš 1~000 į 10~000, iš 10~000 į 100~000 bei iš 100~000 į 1~000~000, sumažėjo atitinkamai 35,7\%, 65,8\% ir 33,7\%.
            
            \input{attachments/tables/fnn_sferos_funkc_su_triuksmu}

            Vertinant modelio tikslumo pokytį tarp švarios ir triukšmingos duomenų aibių, matyti, kad mažiausią įtaką triukšmas turėjo duomenų aibei su 1~000~000 taškų – modelio absoliučios paklaidos vidurkis padidėjo 0,9\%, o standartinis nuokrypis – 1,8\%. Šiek tiek didesni pokyčiai stebimi bandymuose su 1~000 įrašų duomenų aibe, kur vidurkis padidėjo 11,1\%, o standartinis nuokrypis – 55,1\%. Didžiausi pakitimai pastebimi nagrinėjant 10~000 ir 100~000 įrašų duomenų aibes: šiose aibėse vidurkis padidėjo atitinkamai 240\% ir 146,3\%, o standartinis nuokrypis – 138,4\% ir 144,1\%.
    
    \subsection{Bandymai su k artimiausių kaimynų metodu}

        \subsubsection{Modeliai}
            
            Dirbtinio neuroninio tinklo įvertinimui tos pačios duomenų aibės buvo panaudotos ir su k artimiausių kaimynų metodu. 85\% kiekvienos duomenų aibės įrašų buvo skiriami duomenų saugojimui ir validavimui, o likę 15\% – modelio testavimui. Modeliai buvo validuojami pasitelkiant kryžminę validaciją (angl. \textit{cross-validation}). Nustatyta, kad geriausi rezultatai pasiekiami, kai kaimynų skaičius lygus 3, tačiau palyginimui buvo atlikti ir bandymai su vienu artimiausiu kaimynu.

        \subsubsection{Rezultatai, kai k = 1}

            \input{attachments/tables/nn_sferos_funkc_svarus}
            \input{attachments/tables/nn_sferos_funkc_su_triuksmu}

        \subsubsection{Rezultatai, kai k = 3}

            \input{attachments/tables/knn_sferos_funkc_svarus}
            \input{attachments/tables/knn_sferos_funkc_su_triuksmu}

        % \subsection{Bandymai su k artimiausių kaimynų metodu}

        %     Tyrimas buvo atliktas su 1~000, 10~000, 100~000, 1~000~000 ir 10~000~000 taškų aibėmis, kurių $85\%$ buvo skiriami modelio apmokymui ir validavimui, likę $15\%$ - modelio testavimui.

        %     \subsubsection{K artimiausių kaimynų metodo rezultatų palyginimas}

        %         Palyginus metodo rezultatus, kai $k = 1$ ir $k = 3$ yra akivaizdu, kad su didesniu kaimynų kiekiu, modelis grąžina geresnius rezultatus. Taip pat matome, kad abiem atvejais, modelių grąžinami rezultatai stabiliai gerėjo.
